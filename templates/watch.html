<!DOCTYPE html>
<html>
<head>
    <title>Watch Stream</title>
</head>
<body>
    <h1>Watching Stream: {{ device_id }}</h1>
    <div>
        <video id="live-stream" controls autoplay>
            Your browser does not support the video tag.
        </video>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.js"></script>
    <script>
        var socket = io();
        var deviceId = "{{ device_id }}";

        socket.on('connect', function() {
            socket.emit('transmit_stream', { device_id: deviceId });
        });

        socket.on('message', function(data) {
            var videoElement = document.getElementById('live-stream');
            videoElement.src = window.URL.createObjectURL(new Blob([data], { type: 'video/mp4' }));
        });

        socket.on('error', function(error) {
            console.error('Error: ', error);
        });
    </script>
</body>
</html>
